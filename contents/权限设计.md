#### 数据模型

比较灵活的方案是，增加“角色”来解藕“用户”和“权限”，即“用户”多对多“角色”，“角色”多对多“权限”。

确定“角色”时，可以类比组织内的职务。

“权限”的结构，可以是简单的列表，也可以是树结构，一般“父权限”可以对应某资源的“查看”权限，它的“子权限”对应该资源的“修改”、“删除”等操作，因为这些操作都基于“查看”权限。

对于树结构的“权限”，传统数据库可以通过一列“父权限ID”的方式来保存。

因为一般“角色”和“权限”数据不会很大，一般可以永久存放在缓存或者内存中，数据库中的数据更新后，通过消息传递给程序，程序再更新缓存或内存中的“角色”和“权限”数据。

确定数据模型后，再确定相应的存储模型，设计好数据库。

#### 身份验证

首先是“载体”问题，如果要支持移动APP，一般采用token而不是session的形式，因为移动APP一般不像浏览器那样内置使用cookie，而session需要客户端支持cookie。

客户端在请求中加入token，服务端根据token确定是那个用户。

#### 鉴权

确定用户后，后端负责确定此用户有没有此请求的权限，也就是“鉴权”过程。

一般是根据用户ID，查询有哪些角色，再根据这些角色，查询有哪些权限，再合并、去重、缓存，如果查到的权限集合中包含了此请求的权限，开始执行具体的业务，负责直接返回403错误

#### 前端控制

前端控制不是为了安全，是为了提高用户体验，让用户一目了然自己可以有哪些操作，避免了用户进行未授权的操作时，弹出烦人的错误提示。

前端控制，可以是把未授权的操作入口隐藏掉，也可以是把未授权的操作入口disable掉。

用户登录后，服务端不止要返回token，也要返回此用户的权限列表（或权限树），这样，前端就可以根据这个权限列表或权限树，隐藏或disable掉未授权的权限了。
